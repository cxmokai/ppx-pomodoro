<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/vite.svg" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Pomodoro Timer</title>

        <!-- Preconnect to Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <!-- Preload critical font -->
        <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">

        <!-- Critical CSS to prevent FOUC -->
        <script>
            // Get saved theme immediately to set correct background
            (function() {
                var saved = localStorage.getItem('pomodoro-settings');
                var theme = 'dark';
                if (saved) {
                    try {
                        var parsed = JSON.parse(saved);
                        if (parsed.theme === 'light' || parsed.theme === 'dark') {
                            theme = parsed.theme;
                        }
                    } catch (e) {}
                }
                document.documentElement.setAttribute('data-theme', theme);
            })();
        </script>

        <style>
            /* Set background immediately based on theme */
            html[data-theme="dark"] {
                background: #1a1c2c;
            }
            html[data-theme="light"] {
                background: #e8e4d9;
            }

            body {
                margin: 0;
                padding: 0;
                font-family: 'Courier New', Courier, monospace;
            }

            /* Loading overlay instead of hiding content */
            #loading-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: opacity 0.15s ease-out;
            }

            html[data-theme="dark"] #loading-overlay {
                background: #1a1c2c;
            }

            html[data-theme="light"] #loading-overlay {
                background: #e8e4d9;
            }

            /* Pixel loading text */
            .loading-text {
                font-size: 12px;
                animation: pixel-blink 1s step-end infinite;
            }

            html[data-theme="dark"] .loading-text {
                color: #f4f4f4;
            }

            html[data-theme="light"] .loading-text {
                color: #2d2d2d;
            }

            @keyframes pixel-blink {
                0%, 49% { opacity: 1; }
                50%, 100% { opacity: 0; }
            }

            /* Hide overlay when fonts ready */
            html.fonts-loaded #loading-overlay,
            html.fonts-fallback #loading-overlay {
                opacity: 0;
                pointer-events: none;
            }

            /* Pixel font when loaded */
            html.fonts-loaded body {
                font-family: 'Press Start 2P', 'Courier New', Courier, monospace;
            }
        </style>

        <!-- Font loading detection -->
        <script>
            if (document.fonts) {
                document.fonts.ready.then(function() {
                    document.documentElement.classList.add('fonts-loaded');
                });
                setTimeout(function() {
                    if (!document.documentElement.classList.contains('fonts-loaded')) {
                        document.documentElement.classList.add('fonts-fallback');
                    }
                }, 150);
            } else {
                document.documentElement.classList.add('fonts-loaded');
            }
        </script>
    </head>
    <body>
        <div id="loading-overlay">
            <div class="loading-text">LOADING...</div>
        </div>
        <div id="root"></div>
        <script type="module" src="/src/main.tsx"></script>
    </body>
</html>
